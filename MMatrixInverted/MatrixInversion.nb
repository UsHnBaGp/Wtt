(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48627,       1171]
NotebookOptionsPosition[     43932,       1093]
NotebookOutlinePosition[     44381,       1110]
CellTagsIndexPosition[     44338,       1107]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.87811300077658*^9, 
  3.878113003071019*^9}},ExpressionUUID->"055e0ccd-04f9-4917-86a7-\
fc44b724b1eb"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8789748302068377`*^9, 3.878974831978478*^9}, {
  3.88251693317936*^9, 3.8825169356586733`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"be39feab-72ef-4e9a-b8ad-33f7ccd2252c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", "\"\</scratch/ge84fet/Wtt/Kira\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.882516937731337*^9, 3.882517009316174*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"508c8a09-28a6-469f-9aff-fb169ee2a05e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/saraditsch/Desktop/Wtt/MMatrixInverted/Kira\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8830252851209*^9, 3.883025327122313*^9}, {
  3.88451178234912*^9, 3.884511793450132*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"a0794a04-1e4c-4083-8223-334d0a2b8b6a"],

Cell[CellGroupData[{

Cell["Matrix Inversion", "Title",
 CellChangeTimes->{{3.882510087815831*^9, 
  3.8825100921599493`*^9}},ExpressionUUID->"7cb34262-fcea-4631-a587-\
bc20b943a3b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Custom", " ", "Funktions"}]], "Subsubsection",
 CellChangeTimes->{{3.882510882350911*^9, 
  3.882510897909676*^9}},ExpressionUUID->"47ee0a99-1afa-47d1-b6a9-\
d7a31932dbae"],

Cell[CellGroupData[{

Cell["CoefficientToKira", "Item",ExpressionUUID->"bd71f5c9-294f-4e0d-96d8-fc67ba08943e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CoefficientToKira", "[", 
   RowBox[{"VarCoefficient_", ",", "VarWeight_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{
    RowBox[{"{", "KiraFileLine", "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"VarCoefficient", "===", "0"}], ",", 
       RowBox[{"Return", "[", "\"\<\>\"", "]"}]}], "]"}], ";", "\n", "\n", 
     RowBox[{"KiraFileLine", "=", 
      RowBox[{
       RowBox[{"ToString", "[", "VarWeight", "]"}], "<>", "\"\<*(\>\"", "<>", 
       
       RowBox[{"ToString", "[", 
        RowBox[{"VarCoefficient", ",", "InputForm"}], "]"}], "<>", 
       "\"\<)\\n\>\""}]}], ";", "\n", 
     RowBox[{"Return", "[", 
      RowBox[{"StringDelete", "[", 
       RowBox[{"KiraFileLine", ",", "\"\< \>\""}], "]"}], "]"}], ";"}]}], 
   "\n", "\n", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[129]:=",ExpressionUUID->"12df28c1-0e60-4e08-955f-cabfe6c93e71"]
}, Open  ]],

Cell[CellGroupData[{

Cell["RelationToKira", "Item",ExpressionUUID->"0e67da77-d163-459e-91c4-0c21d07572fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "RelationToKira", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"Ratracer", "->", "False"}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"RelationToKira", "[", 
   RowBox[{"RelationLHS0_", ",", 
    RowBox[{"optn", ":", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"{", 
       RowBox[{"Ratracer", "->", "False"}], "}"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "KiraWeights", ",", "WeightCoef", ",", "LinearKiraWeightQ", ",", 
      "NoWeightLessTermQ", ",", "KiraRelation", ",", "RatRacerRelation"}], 
     "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{"KiraWeights", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"RelationLHS0", ",", "_Global`KiraWeight", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "]"}]}], ";", "\n", 
     
     RowBox[{"WeightCoef", "=", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"RelationLHS0", ",", "KiraWeights"}], "]"}], "//", 
       "Normal"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"Consistency", " ", 
       RowBox[{"check", ":"}]}], " ", "*)"}], "\n", 
     RowBox[{"LinearKiraWeightQ", "=", 
      RowBox[{
       RowBox[{"Length", "[", "WeightCoef", "]"}], "===", "2"}]}], ";", "\n", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", "LinearKiraWeightQ", "]"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Error: Equation is not linear. Check input.\>\"", 
         "]"}], ";", " ", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", 
     RowBox[{"NoWeightLessTermQ", "=", 
      RowBox[{
       RowBox[{"WeightCoef", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "==", "0"}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", "NoWeightLessTermQ", "]"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Error: Constant term is not 0. Check input.\>\"", 
         "]"}], ";", " ", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"Remove", " ", "helper", " ", "function", " ", "KiraWeight"}], 
      "*)"}], "\n", 
     RowBox[{"KiraWeights", "=", 
      RowBox[{"KiraWeights", "[", 
       RowBox[{"[", 
        RowBox[{";;", ",", "1"}], "]"}], "]"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"Remove", " ", "0", " ", "coefficients"}], "*)"}], "\n", 
     RowBox[{"WeightCoef", "=", 
      RowBox[{"WeightCoef", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"Convert", " ", "to", " ", "Kira", " ", 
       RowBox[{"string", ":"}]}], " ", "*)"}], "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "Ratracer", "]"}], ",", " ", "\n", 
       RowBox[{
        RowBox[{"RatRacerRelation", "=", 
         RowBox[{"StringJoin", "@", 
          RowBox[{"MapThread", "[", 
           RowBox[{"CoefficientToRatracer", ",", 
            RowBox[{"{", 
             RowBox[{"WeightCoef", ",", "KiraWeights"}], "}"}]}], "]"}]}]}], 
        ";", "\n", 
        RowBox[{"Return", "[", "RatRacerRelation", "]"}]}]}], "\n", "]"}], 
     ";", "\n", "\n", 
     RowBox[{"KiraRelation", "=", 
      RowBox[{"StringJoin", "@", 
       RowBox[{"MapThread", "[", 
        RowBox[{"CoefficientToKira", ",", 
         RowBox[{"{", 
          RowBox[{"WeightCoef", ",", "KiraWeights"}], "}"}]}], "]"}]}]}], ";",
      "\n", 
     RowBox[{"Return", "[", "KiraRelation", "]"}]}]}], "\n", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[130]:=",ExpressionUUID->"a88ec5c1-f8d6-456c-8e60-86412aaa74b3"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"KiraFriendlyMandelstam", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "->", "s12"}], ",", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "->", "s13"}], ",", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"1", ",", "4"}], "]"}], "->", "s14"}], ",", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "->", "s23"}], ",", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "->", "s24"}], ",", " ", 
      RowBox[{
       RowBox[{"SMP", "[", "\"\<m_W\>\"", "]"}], "->", "mw"}], ",", 
      RowBox[{
       RowBox[{"SMP", "[", "\"\<m_t\>\"", "]"}], "->", "mt"}]}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.882523673168398*^9, 3.882523781238356*^9}, {
   3.882523850198483*^9, 3.882523882318448*^9}, {3.8830397702399397`*^9, 
   3.883039828752768*^9}, 3.883039931258398*^9, {3.8868328679573507`*^9, 
   3.8868328689102793`*^9}},ExpressionUUID->"ea411e1d-edb6-4e90-bf07-\
d8513d3487a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMatrix", "=", 
   RowBox[{
    RowBox[{
    "Get", "[", "\"\</scratch/ge84fet/Wtt/Mathematica/MMatrixInitial\>\"", 
     "]"}], "//.", "KiraFriendlyMandelstam"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.882517128734056*^9, 3.882517140534173*^9}, {
   3.882517569438634*^9, 3.882517895706627*^9}, {3.882518196657366*^9, 
   3.8825181971537247`*^9}, {3.882518227442746*^9, 3.8825182278245583`*^9}, {
   3.882518305419487*^9, 3.882518351530923*^9}, {3.88251845490143*^9, 
   3.882518455186317*^9}, {3.882520432104083*^9, 3.8825204326858053`*^9}, {
   3.882520593690892*^9, 3.8825206026240892`*^9}, {3.882520649105104*^9, 
   3.8825206661134443`*^9}, {3.882520881126977*^9, 3.8825208929726753`*^9}, {
   3.882520925734002*^9, 3.882520927133872*^9}, {3.882520988678668*^9, 
   3.882520990230831*^9}, {3.882521099563155*^9, 3.882521144758987*^9}, {
   3.882523001496752*^9, 3.8825230030082006`*^9}, {3.882523769485346*^9, 
   3.882523795804907*^9}, 3.8825238357181168`*^9, {3.8830244347908983`*^9, 
   3.883024568813672*^9}, 3.883025354621068*^9, {3.883304662900185*^9, 
   3.883304668784582*^9}},ExpressionUUID->"607ff344-da3a-454f-95a9-\
0cef3ef84af8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMatrix", "=", 
   RowBox[{
    RowBox[{
    "Get", "[", 
     "\"\</Users/saraditsch/Desktop/Wtt/MMatrix/Mathematica/MMatrix\>\"", 
     "]"}], "//.", "KiraFriendlyMandelstam"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883025360583164*^9, 3.883025376593863*^9}, {
  3.883304658241995*^9, 3.883304660229949*^9}, {3.8833321178466682`*^9, 
  3.88333212010888*^9}, {3.883332463282627*^9, 3.883332467839541*^9}, {
  3.883720956161632*^9, 3.8837209864493103`*^9}, {3.884511829025792*^9, 
  3.884511830397563*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"8339428a-83b4-4627-bf23-40c729e2d4df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Matrix", "=", "MMatrix"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KiraWantedSolutionsFileName", "=", "\"\<Wanted.kira\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EquationsFileName", "=", "\"\<Eqs.kira\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.882517128734056*^9, 3.882517140534173*^9}, {
   3.882517569438634*^9, 3.882517895706627*^9}, {3.882518196657366*^9, 
   3.8825181971537247`*^9}, {3.882518227442746*^9, 3.8825182278245583`*^9}, {
   3.882518305419487*^9, 3.882518351530923*^9}, {3.88251845490143*^9, 
   3.882518455186317*^9}, {3.882520432104083*^9, 3.8825204326858053`*^9}, {
   3.882520593690892*^9, 3.8825206026240892`*^9}, {3.882520649105104*^9, 
   3.8825206661134443`*^9}, {3.882520881126977*^9, 3.8825208929726753`*^9}, {
   3.882520925734002*^9, 3.882520927133872*^9}, {3.882520988678668*^9, 
   3.882520990230831*^9}, {3.882521099563155*^9, 3.882521169825622*^9}, {
   3.882521219961616*^9, 3.882521220378454*^9}, {3.88252314823557*^9, 
   3.882523157698457*^9}, 3.882523357765224*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"031a21fe-beee-4ad9-8a4c-9d68bccc1170"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Length", "[", "Matrix", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InitKiraWeight", "[", 
    RowBox[{"MinWeight_", ",", "MaxWeight_"}], "]"}], ":=", 
   RowBox[{"KiraWeight", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"MinWeight", ",", "MaxWeight"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KiraWeights", "=", 
   RowBox[{"InitKiraWeight", "[", 
    RowBox[{"1", ",", 
     RowBox[{"2", "*", "L"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlSys", "=", 
   RowBox[{
    RowBox[{"KiraWeights", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "L"}], "]"}], "]"}], "-", 
    RowBox[{"Matrix", ".", 
     RowBox[{"KiraWeights", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"L", "+", "1"}], ";;", 
        RowBox[{"2", "*", "L"}]}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "EquationsFileName", "]"}], ",", 
    RowBox[{"DeleteFile", "[", "EquationsFileName", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateFile", "[", "EquationsFileName", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toWrite", "=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"RelationToKira", "[", "#", "]"}], "&"}], ",", " ", "GlSys"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"WriteLine", "[", 
      RowBox[{"EquationsFileName", ",", "#"}], "]"}], "&"}], ",", "toWrite"}],
    " ", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.882507514673504*^9, 3.8825075815671587`*^9}, {
   3.882507641176906*^9, 3.882507779876562*^9}, {3.882508950947246*^9, 
   3.882508957814443*^9}, 3.882509338445046*^9, 3.882509466198679*^9, {
   3.882511109202259*^9, 3.882511122832456*^9}, {3.882511315558943*^9, 
   3.882511331773209*^9}, {3.882511362660345*^9, 3.882511369126089*^9}, {
   3.8825116404958878`*^9, 3.8825116418022327`*^9}, 3.882516442279642*^9, {
   3.8825170219890203`*^9, 3.882517123135357*^9}, {3.882517161182789*^9, 
   3.882517192200309*^9}, {3.882517349978162*^9, 3.882517372346681*^9}, {
   3.8825174650279837`*^9, 3.882517499668741*^9}, {3.88251753484645*^9, 
   3.882517553663074*^9}, {3.8825179128859253`*^9, 3.8825179268196583`*^9}, {
   3.882517965180863*^9, 3.882518096614375*^9}, {3.882518129897043*^9, 
   3.882518194105196*^9}, {3.8825182671471157`*^9, 3.882518369604157*^9}, {
   3.88251842538387*^9, 3.882518438564383*^9}, {3.882520382276948*^9, 
   3.8825203839725943`*^9}, {3.882520415957198*^9, 3.882520427045065*^9}, {
   3.88252051793115*^9, 3.882520527287592*^9}, 3.882520689644404*^9, {
   3.882520751304864*^9, 3.882520806160285*^9}, {3.882520849324774*^9, 
   3.882520872253145*^9}, {3.88252091699623*^9, 3.882520954003893*^9}, {
   3.882521086577263*^9, 3.882521093169107*^9}, {3.882521128499814*^9, 
   3.882521129341393*^9}, 3.882521301840394*^9, {3.882522819413805*^9, 
   3.882522822149641*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"9e3dd6f8-487b-462c-833c-ab7f50d1507e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "KiraWantedSolutionsFileName", "]"}], ",", 
    RowBox[{"DeleteFile", "[", "KiraWantedSolutionsFileName", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateFile", "[", "KiraWantedSolutionsFileName", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"WriteLine", "[", 
      RowBox[{"KiraWantedSolutionsFileName", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"ToString", "/@", 
     RowBox[{"KiraWeights", "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "1"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "\"\<kira.log\>\"", "]"}], ",", 
    RowBox[{"DeleteFile", "[", "\"\<kira.log\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "\"\<results\>\"", "]"}], ",", 
    RowBox[{"DeleteDirectory", "[", 
     RowBox[{"\"\<results\>\"", ",", 
      RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "\"\<firefly_saves\>\"", "]"}], ",", 
    RowBox[{"DeleteDirectory", "[", 
     RowBox[{"\"\<firefly_saves\>\"", ",", 
      RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "\"\<sectormappings\>\"", "]"}], ",", 
    RowBox[{"DeleteDirectory", "[", 
     RowBox[{"\"\<sectormappings\>\"", ",", 
      RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DirectoryQ", "[", "\"\<tmp\>\"", "]"}], ",", 
    RowBox[{"DeleteDirectory", "[", 
     RowBox[{"\"\<tmp\>\"", ",", 
      RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8636677590306892`*^9, 3.863667836693529*^9}, {
   3.86367162522437*^9, 3.863671627511902*^9}, {3.863831704316319*^9, 
   3.8638317473182364`*^9}, 3.8638320240233717`*^9, {3.863832570975067*^9, 
   3.863832584553403*^9}, {3.863832755562273*^9, 3.86383275617747*^9}, {
   3.882520671431569*^9, 3.8825206765294237`*^9}, 3.882520841037971*^9, {
   3.882523591215365*^9, 3.882523625762334*^9}, {3.882524175698152*^9, 
   3.882524176256186*^9}, {3.8830246663199453`*^9, 3.8830247421211157`*^9}, {
   3.883024780177924*^9, 3.88302489241147*^9}, {3.8830394043692904`*^9, 
   3.88303940497724*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"5bda735d-a72c-4ec4-92b1-6c40e79424b5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check Inversion", "Subsubsection",
 CellChangeTimes->{{3.883039410305052*^9, 
  3.883039421801496*^9}},ExpressionUUID->"f1c102a2-66d3-4e8b-9565-\
52cc65d84cb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMatrixInv", "=", 
   RowBox[{
   "Get", "[", 
    "\"\</scratch/ge84fet/Wtt/Kira/results/Tuserweight/kira_Wanted.kira.m\>\"\
", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8830394332175922`*^9, 3.8830395477479057`*^9}, {
   3.883040176302703*^9, 3.8830401768868017`*^9}, 3.883041786843067*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"81befdfe-33c7-4250-8c4d-55ed11857f68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMatrixInv", "=", 
   RowBox[{
   "Get", "[", 
    "\"\</Users/saraditsch/Desktop/Wtt/MMatrixInverted/Kira/Results/\
Tuserweight/kira_Wanted.kira.m\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8831149660087767`*^9, 3.883114990513899*^9}, {
  3.883311147216325*^9, 3.883311147837111*^9}, {3.883332486247593*^9, 
  3.8833325279301643`*^9}, {3.884513390672085*^9, 3.8845134004668694`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"f025af67-0ad5-4d02-af9d-da7bbc5787e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MMatrixInverse", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"MMatrixInv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"Tuserweight", "[", "j", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "L"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8830406663196087`*^9, 3.883040785185154*^9}, {
  3.883041083798958*^9, 3.883041118111375*^9}, {3.883041545918479*^9, 
  3.883041743201416*^9}, {3.883041789898725*^9, 3.8830417916266937`*^9}, {
  3.883041830259038*^9, 3.883041837899083*^9}, {3.88311502979915*^9, 
  3.883115045001045*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"252a5dbe-1b70-4b8d-85e3-adb8d4f8f45c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomKinematics", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s12", "->", 
      RowBox[{"RandomPrime", "[", "100000", "]"}]}], ",", 
     RowBox[{"s13", "->", 
      RowBox[{"RandomPrime", "[", "100000", "]"}]}], ",", 
     RowBox[{"s14", "->", 
      RowBox[{"RandomPrime", "[", "100000", "]"}]}], ",", 
     RowBox[{"s23", "->", 
      RowBox[{"RandomPrime", "[", "100000", "]"}]}], ",", 
     RowBox[{"s24", "->", 
      RowBox[{"RandomPrime", "[", "100000", "]"}]}], ",", 
     RowBox[{"mW", "->", 
      RowBox[{"RandomPrime", "[", "100000", "]"}]}], ",", 
     RowBox[{"mt", "->", 
      RowBox[{"RandomPrime", "[", "100000", "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.883725191490347*^9, 3.883725276783647*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"8678160a-6ee8-44df-af86-1404324f111c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"MMatrix", "//.", "RandomKinematics"}], ")"}], ".", 
  RowBox[{"(", 
   RowBox[{"MMatrixInverse", "//.", "RandomKinematics"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8837266344091253`*^9, 3.883726656693365*^9}, 
   3.8837267247908783`*^9, {3.884513497018202*^9, 3.884513501072071*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"b6620d06-355c-45b6-b437-57e7faa1cb4f"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "1", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "1", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "1", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.883726659990128*^9, 3.883726726432148*^9, 
  3.8837267619946423`*^9, 3.884513511832806*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"894d844e-e522-45db-a06e-fbce58c027dc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Put", "[", 
   RowBox[{
   "MMatrixInverse", ",", 
    "\"\</Users/saraditsch/Desktop/Wtt/MMatrixInverted/MatrixInverse\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.884513612736952*^9, 3.884513677778019*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"091d157a-e73c-4431-9181-ae92225bd953"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplify MInverse", "Subsubsection",
 CellChangeTimes->{{3.8845135416668377`*^9, 
  3.884513553412118*^9}},ExpressionUUID->"c93c5a14-1ef1-4a6a-866e-\
0acbad9cff45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MInvSimplified", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MMatrixInverse", "//", "Together"}], "//", "Simplify"}], "//", 
    "Together"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8845135659410152`*^9, 3.884513572226129*^9}, {
  3.884513684708699*^9, 3.8845136987998943`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"ac75fc76-6229-41e7-8110-064bf100044f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Put", "[", 
   RowBox[{
   "MInvSimplified", ",", 
    "\"\</Users/saraditsch/Desktop/Wtt/MMatrixInverted/MatrixInverse_\
Simplified\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.88452466718852*^9, 3.884524673991707*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"f55f59f6-e41e-4d0d-87bf-5d787f2b23ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["", "\[Placeholder]"], "Write", " ", "Invers", " ", "Matrix",
   " ", "in", " ", "Form", " ", "Style"}]], "Subsubsection",
 CellChangeTimes->{{3.8854472624284163`*^9, 
  3.885447277116952*^9}},ExpressionUUID->"99122174-201a-47c7-83bf-\
f5cdc2e55f87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MInv", "=", 
   RowBox[{
   "Get", "[", 
    "\"\</Users/saraditsch/Desktop/Wtt/MMatrixInverted/MatrixInverse_\
Simplified\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8854472312819757`*^9, 3.885447280656085*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"32a8b8fa-ddae-45f0-bde8-c338eb110054"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/saraditsch/Desktop/Wtt/TreeLevelAmplitude\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.885450796063321*^9, 3.885450797610375*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"36b6b87a-f400-49ce-877a-4e28bedaeb6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CreateFile", "[", "\"\<MMatrixInverseForm.txt\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.885447288730072*^9, 3.885447294996319*^9}, {
   3.8854474695840797`*^9, 3.8854474867980757`*^9}, {3.885447524059506*^9, 
   3.885447547214971*^9}, {3.8854507014155483`*^9, 3.8854507624753227`*^9}, {
   3.885450823880666*^9, 3.8854508452643137`*^9}, 3.885450888202447*^9, {
   3.885452288131936*^9, 3.88545228922395*^9}, {3.8854523845486193`*^9, 
   3.885452385156046*^9}, 3.8854524234790688`*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"b1ad2c16-d47e-4cc9-9091-ad0be78bf71c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OpenWrite", "[", "\"\<MMatrixInverseForm.txt\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"WriteLine", "[", 
       RowBox[{"\"\<MMatrixInverseForm.txt\>\"", ",", 
        RowBox[{"\"\<global MInv\>\"", "<>", 
         RowBox[{"ToString", "[", "i", "]"}], "<>", 
         RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<=\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"Numerator", "[", 
            RowBox[{"MInv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
           "InputForm"}], "]"}], "<>", "\"\<*den(\>\"", "<>", 
         RowBox[{"ToString", "[", " ", 
          RowBox[{
           RowBox[{"gram", "[", 
            RowBox[{"MInv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], ",", 
           "InputForm"}], "]"}], "<>", "\"\<);\>\""}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "24"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "24"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "\"\<MMatrixInverseForm.txt\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.8854524308496723`*^9, {3.885452492918317*^9, 3.885452497071456*^9}, {
   3.885452572940009*^9, 3.8854526917390842`*^9}, {3.885452792034646*^9, 
   3.88545290181031*^9}, {3.885452952297699*^9, 3.885453082789961*^9}, {
   3.885453173107747*^9, 3.885453205714843*^9}, {3.885453242805834*^9, 
   3.8854532567835493`*^9}, {3.885453316826528*^9, 3.8854533174616423`*^9}, 
   3.8874714686380587`*^9},ExpressionUUID->"99bae985-d0e4-4a4c-bedc-\
fa119b26383b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/saraditsch/Desktop/Wtt/TreeLevelAmplitude\>\"", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.885447288730072*^9, 3.885447294996319*^9}, {
   3.8854474695840797`*^9, 3.8854474867980757`*^9}, {3.885447524059506*^9, 
   3.885447547214971*^9}, {3.8854507014155483`*^9, 3.8854507624753227`*^9}, {
   3.885450823880666*^9, 3.8854508452643137`*^9}, 3.885450888202447*^9, {
   3.885452288131936*^9, 3.88545228922395*^9}, {3.8854523845486193`*^9, 
   3.885452385156046*^9}, 3.8854524234790688`*^9, {3.8854544078584757`*^9, 
   3.88545440834741*^9}, {3.8854550046915407`*^9, 3.885455031398415*^9}, {
   3.88598165494053*^9, 
   3.885981682845819*^9}},ExpressionUUID->"d0a975e0-61f8-42eb-883b-\
38f0f7add731"],

Cell[BoxData[
 FormBox["\<\"/Users/saraditsch/Desktop/Wtt/TreeLevelAmplitude\"\>", 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.885981679237043*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"050f0f55-d209-42c2-b2de-7e7809a7fe34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Mnew", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"num", "[", 
          RowBox[{"Numerator", "[", 
           RowBox[{
            RowBox[{"MInv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "//", "Together"}], 
           "]"}], "]"}], "*", 
         RowBox[{"den", "[", 
          RowBox[{"gram", "[", 
           RowBox[{
            RowBox[{"MInv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "//", "Together"}], 
           "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "24"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "24"}], "}"}]}], "]"}], "//.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"den", "[", 
         RowBox[{"Power", "[", 
          RowBox[{"a__", ",", "b_"}], "]"}], "]"}], ":>", 
        RowBox[{
         RowBox[{"den", "[", "a", "]"}], "^", "b"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dens", "=", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"Mnew", ",", "_den", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "]"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"den", "[", "a__", "]"}], "->", "a"}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gram", "=", 
     RowBox[{"dens", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"gram", "//", "InputForm"}]}]}]], "Input",
 CellChangeTimes->{{3.88597746041545*^9, 3.885977519748171*^9}, {
   3.8859775768509197`*^9, 3.8859776463794003`*^9}, {3.885977690809355*^9, 
   3.885977725874331*^9}, {3.885977956017666*^9, 3.885978037081164*^9}, {
   3.885978342823286*^9, 3.88597834808759*^9}, {3.885978383444944*^9, 
   3.885978558280559*^9}, {3.885980121800577*^9, 3.885980136736528*^9}, {
   3.8859801887260447`*^9, 3.885980199186057*^9}, {3.885980906024167*^9, 
   3.885980906614643*^9}, {3.885981689634136*^9, 3.885981704470643*^9}, {
   3.885982040410452*^9, 3.8859820691366262`*^9}, {3.8860635462204123`*^9, 
   3.886063554907652*^9}, 3.8861499481930017`*^9, {3.886149982071575*^9, 
   3.8861502339292173`*^9}, {3.8861502981647778`*^9, 
   3.8861503106602297`*^9}, {3.886150568291362*^9, 3.8861505798098583`*^9}, 
   3.886153578529533*^9, {3.887256585204096*^9, 3.887256592550549*^9}, {
   3.8874713329282017`*^9, 3.887471338673676*^9}, 
   3.887471468638764*^9},ExpressionUUID->"04a0c601-35e0-45f7-82bc-\
c1080de44dc5"],

Cell["\<\
-4*mt^4*mw^2*s12 + 4*mt^4*s12^2 + 4*mt^2*mw^2*s12^2 + mw^4*s12^2 - \
4*mt^2*s12^3 - 2*mw^2*s12^3 + s12^4 + 
 4*mt^4*s12*s13 + 2*mt^2*mw^2*s12*s13 - 6*mt^2*s12^2*s13 - 2*mw^2*s12^2*s13 + \
2*s12^3*s13 + mt^4*s13^2 - 
 2*mt^2*s12*s13^2 + s12^2*s13^2 + 4*mt^4*s12*s14 + 2*mt^2*mw^2*s12*s14 - \
6*mt^2*s12^2*s14 - 
 2*mw^2*s12^2*s14 + 2*s12^3*s14 - 2*mt^4*s13*s14 - 4*mt^2*s12*s13*s14 + \
2*s12^2*s13*s14 + mt^4*s14^2 - 
 2*mt^2*s12*s14^2 + s12^2*s14^2 + 4*mt^4*s12*s23 + 2*mt^2*mw^2*s12*s23 - \
6*mt^2*s12^2*s23 - 
 2*mw^2*s12^2*s23 + 2*s12^3*s23 - 2*mt^4*s13*s23 + 2*s12^2*s13*s23 + \
2*mt^4*s14*s23 - 8*mt^2*s12*s14*s23 - 
 2*mw^2*s12*s14*s23 + 4*s12^2*s14*s23 + 2*mt^2*s13*s14*s23 + \
2*s12*s13*s14*s23 - 2*mt^2*s14^2*s23 + 
 2*s12*s14^2*s23 + mt^4*s23^2 - 2*mt^2*s12*s23^2 + s12^2*s23^2 - \
2*mt^2*s14*s23^2 + 2*s12*s14*s23^2 + 
 s14^2*s23^2 + 4*mt^4*s12*s24 + 2*mt^2*mw^2*s12*s24 - 6*mt^2*s12^2*s24 - \
2*mw^2*s12^2*s24 + 2*s12^3*s24 + 
 2*mt^4*s13*s24 - 8*mt^2*s12*s13*s24 - 2*mw^2*s12*s13*s24 + 4*s12^2*s13*s24 - \
2*mt^2*s13^2*s24 + 
 2*s12*s13^2*s24 - 2*mt^4*s14*s24 + 2*s12^2*s14*s24 + 2*mt^2*s13*s14*s24 + \
2*s12*s13*s14*s24 - 
 2*mt^4*s23*s24 - 4*mt^2*s12*s23*s24 + 2*s12^2*s23*s24 + 2*mt^2*s13*s23*s24 + \
2*s12*s13*s23*s24 + 
 2*mt^2*s14*s23*s24 + 2*s12*s14*s23*s24 - 2*s13*s14*s23*s24 + mt^4*s24^2 - \
2*mt^2*s12*s24^2 + s12^2*s24^2 - 
 2*mt^2*s13*s24^2 + 2*s12*s13*s24^2 + s13^2*s24^2\
\>", "Output",
 CellChangeTimes->{
  3.886153587264566*^9, 3.886833925439412*^9, {3.887256583019115*^9, 
   3.887256600868726*^9}, 3.887431367379797*^9, {3.887441670972488*^9, 
   3.887441687415943*^9}},
 CellLabel->
  "Out[12]//InputForm=",ExpressionUUID->"5297fe69-a77f-455d-9bd7-\
b4fa921f97d4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mnew2", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Mnew", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"den", "[", "gram", "]"}], "->", 
          RowBox[{"den", "[", "gram", "]"}]}], ",", 
         RowBox[{
          RowBox[{"den", "[", 
           RowBox[{"-", "gram"}], "]"}], "->", 
          RowBox[{"-", 
           RowBox[{"den", "[", "gram", "]"}]}]}]}], "}"}]}], ")"}], "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"num", "[", "a__", "]"}], ":>", 
        RowBox[{"num", "[", 
         RowBox[{"Factor", "[", "a", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"den", "[", "a__", "]"}], ":>", 
        RowBox[{"den", "[", 
         RowBox[{"Factor", "[", "a", "]"}], "]"}]}]}], "}"}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8861505709804487`*^9, 3.886150619140037*^9}, {
  3.886150658260377*^9, 3.886150698691764*^9}, {3.886150757459461*^9, 
  3.8861507618625727`*^9}, {3.886153604589673*^9, 3.8861536067250357`*^9}, {
  3.886153704013233*^9, 3.886153708411388*^9}, {3.887471468639613*^9, 
  3.8874714686400547`*^9}},ExpressionUUID->"98805845-431d-4506-868c-\
4f2ed5e6a65e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Mnew3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Mnew2", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"num", "[", 
          RowBox[{"a_", "*", "b_"}], "]"}], "->", 
         RowBox[{
          RowBox[{"num", "[", "a", "]"}], "*", 
          RowBox[{"num", "[", "b", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"den", "[", 
          RowBox[{"a_", "*", "b_"}], "]"}], "->", 
         RowBox[{
          RowBox[{"den", "[", "a", "]"}], "*", 
          RowBox[{"den", "[", "b", "]"}]}]}]}], "}"}]}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"num", "[", 
        RowBox[{"a_", "?", "NumericQ"}], "]"}], "->", "a"}], ",", 
      RowBox[{
       RowBox[{"den", "[", 
        RowBox[{"a_", "?", "NumericQ"}], "]"}], "->", 
       RowBox[{"1", "/", "a"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8861507674494762`*^9, 3.8861507806708*^9}, {
   3.886151079250414*^9, 3.8861511068551197`*^9}, {3.8861512510208693`*^9, 
   3.886151254944721*^9}, 3.886151411584036*^9},
 CellLabel->
  "In[395]:=",ExpressionUUID->"e4c6820a-e78f-415c-adf4-d8c4ccfadc0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Put", "[", 
   RowBox[{
   "Mnew3", ",", " ", 
    "\"\</Users/saraditsch/Desktop/Wtt/MMatrixInverted/MatrixInverse_DenNum\>\
\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.886151455338111*^9, 3.886151498682621*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"5e24e407-e4f4-4a88-bff3-6705ee69d141"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MFile", "=", "\"\<gram.h\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "MFile", "]"}], ",", 
    RowBox[{"DeleteFile", "[", "MFile", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateFile", "[", "MFile", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OpenWrite", "[", "MFile", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteLine", "[", 
   RowBox[{"MFile", ",", 
    RowBox[{"\"\<id denom =\>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"gram", ",", "InputForm"}], "]"}], "<>", "\"\<;\>\""}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "MFile", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8859814336261*^9, 3.88598144608533*^9}, {
  3.885981541934236*^9, 3.885981592872594*^9}, {3.885982591122242*^9, 
  3.885982603364518*^9}, {3.885982638448539*^9, 3.885982653250545*^9}, {
  3.8861500062104597`*^9, 3.886150009951593*^9}, {3.88615038219938*^9, 
  3.886150383512938*^9}, {3.887471468640793*^9, 
  3.887471468641168*^9}},ExpressionUUID->"3a9f75d4-0c5a-4b84-965e-\
393b5330d51e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/saraditsch/Desktop/Wtt/TreeLevelAmplitude/MInv\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MFile", "=", 
      RowBox[{"\"\<MMatrixInverseForm\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.h\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"FileExistsQ", "[", "MFile", "]"}], ",", 
       RowBox[{"DeleteFile", "[", "MFile", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CreateFile", "[", "MFile", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"OpenWrite", "[", "MFile", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"WriteLine", "[", 
        RowBox[{"MFile", ",", 
         RowBox[{"\"\<id MInv\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<=\>\"", "<>", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Mnew3", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "InputForm"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<[\>\"", "->", "\"\<(\>\""}], ",", 
              RowBox[{"\"\<]\>\"", "->", "\"\<)\>\""}]}], "}"}]}], "]"}], 
          "<>", "\"\<;\>\""}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "24"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Close", "[", "MFile", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "24"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8854524308496723`*^9, {3.885452492918317*^9, 3.885452497071456*^9}, {
   3.885452572940009*^9, 3.8854526917390842`*^9}, {3.885452792034646*^9, 
   3.88545290181031*^9}, {3.885452952297699*^9, 3.885453082789961*^9}, {
   3.885453173107747*^9, 3.885453205714843*^9}, {3.885453242805834*^9, 
   3.8854532567835493`*^9}, {3.885453316826528*^9, 3.8854533174616423`*^9}, {
   3.885454410406756*^9, 3.885454471878727*^9}, {3.8854548495238447`*^9, 
   3.8854548728390007`*^9}, {3.885454962471899*^9, 3.885455159453038*^9}, 
   3.885455285521146*^9, {3.885455375455661*^9, 3.885455376092082*^9}, {
   3.8854556137606773`*^9, 3.885455685070038*^9}, {3.88545572576687*^9, 
   3.885455753137883*^9}, {3.885977356811439*^9, 3.885977411511711*^9}, {
   3.885978735907076*^9, 3.88597878384879*^9}, {3.885978838604909*^9, 
   3.885978841219389*^9}, {3.885978896381694*^9, 3.885978936719063*^9}, {
   3.8859800167390137`*^9, 3.8859800567978992`*^9}, 3.8859805217103577`*^9, {
   3.88598060430767*^9, 3.885980607361958*^9}, {3.88598089128181*^9, 
   3.885980920172813*^9}, 3.8859816221658297`*^9, {3.885981794726741*^9, 
   3.885981795059462*^9}, 3.8859818453731413`*^9, {3.885982607456065*^9, 
   3.885982607746808*^9}, {3.885982664280636*^9, 3.885982665251134*^9}, {
   3.8861508479742928`*^9, 3.886150874797366*^9}, {3.886151504815125*^9, 
   3.886151582148108*^9}, {3.8861536530309343`*^9, 3.8861536848111553`*^9}, 
   3.886153736116675*^9, {3.8861537744413977`*^9, 3.886153786251212*^9}, {
   3.886154013140621*^9, 3.886154021271666*^9}, {3.886154104612817*^9, 
   3.886154162838328*^9}},
 CellLabel->
  "In[434]:=",ExpressionUUID->"5c9e5d00-1f8b-4222-bf8b-1b91fea4261c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</Users/saraditsch/Desktop/Wtt/TreeLevelAmplitude/MInv\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MFile", "=", "\"\<MMatrixInverseForm.h\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "MFile", "]"}], ",", 
    RowBox[{"DeleteFile", "[", "MFile", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateFile", "[", "MFile", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OpenWrite", "[", "MFile", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"WriteLine", "[", 
     RowBox[{"MFile", ",", 
      RowBox[{"\"\<id MInv\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", 
       RowBox[{"ToString", "[", "j", "]"}], "<>", "\"\<=\>\"", "<>", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"Mnew3", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "InputForm"}], "]"}],
          ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<[\>\"", "->", "\"\<(\>\""}], ",", 
           RowBox[{"\"\<]\>\"", "->", "\"\<)\>\""}]}], "}"}]}], "]"}], "<>", 
       "\"\<;\>\""}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "24"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "24"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "MFile", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8859807160443287`*^9, 3.88598074627124*^9}, 
   3.885980921951521*^9, 3.885981624670994*^9, {3.885981800799625*^9, 
   3.885981801069075*^9}, 3.885981842928975*^9, {3.88598261219893*^9, 
   3.885982612557786*^9}, {3.8859826673399763`*^9, 3.885982668091556*^9}, {
   3.886150852317276*^9, 3.886150852560112*^9}, {3.8861535251729918`*^9, 
   3.8861535584754744`*^9}, {3.886153644895052*^9, 3.886153647407593*^9}, {
   3.88615416963899*^9, 3.886154170793748*^9}},
 CellLabel->
  "In[427]:=",ExpressionUUID->"cd891501-19e4-4889-b77e-d2f39ddf1bd7"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{979, 742},
WindowMargins->{{16, Automatic}, {Automatic, 41}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (September 30, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d1fd67c7-9754-450a-9a8e-b46159e358a8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 151, 3, 30, "Input",ExpressionUUID->"055e0ccd-04f9-4917-86a7-fc44b724b1eb"],
Cell[712, 25, 253, 5, 30, "Input",ExpressionUUID->"be39feab-72ef-4e9a-b8ad-33f7ccd2252c"],
Cell[968, 32, 262, 5, 30, "Input",ExpressionUUID->"508c8a09-28a6-469f-9aff-fb169ee2a05e"],
Cell[1233, 39, 341, 8, 30, "Input",ExpressionUUID->"a0794a04-1e4c-4083-8223-334d0a2b8b6a"],
Cell[CellGroupData[{
Cell[1599, 51, 161, 3, 98, "Title",ExpressionUUID->"7cb34262-fcea-4631-a587-bc20b943a3b2"],
Cell[CellGroupData[{
Cell[1785, 58, 196, 4, 44, "Subsubsection",ExpressionUUID->"47ee0a99-1afa-47d1-b6a9-d7a31932dbae"],
Cell[CellGroupData[{
Cell[2006, 66, 88, 0, 32, "Item",ExpressionUUID->"bd71f5c9-294f-4e0d-96d8-fc67ba08943e"],
Cell[2097, 68, 977, 25, 215, "Input",ExpressionUUID->"12df28c1-0e60-4e08-955f-cabfe6c93e71",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3111, 98, 85, 0, 32, "Item",ExpressionUUID->"0e67da77-d163-459e-91c4-0c21d07572fd"],
Cell[3199, 100, 3762, 100, 614, "Input",ExpressionUUID->"a88ec5c1-f8d6-456c-8e60-86412aaa74b3",
 InitializationCell->True],
Cell[6964, 202, 1144, 30, 73, "Input",ExpressionUUID->"ea411e1d-edb6-4e90-bf07-d8513d3487a6"],
Cell[8111, 234, 1185, 20, 30, "Input",ExpressionUUID->"607ff344-da3a-454f-95a9-0cef3ef84af8"],
Cell[9299, 256, 623, 13, 30, "Input",ExpressionUUID->"8339428a-83b4-4627-bf23-40c729e2d4df"],
Cell[9925, 271, 1155, 19, 73, "Input",ExpressionUUID->"031a21fe-beee-4ad9-8a4c-9d68bccc1170"],
Cell[11083, 292, 3163, 73, 178, "Input",ExpressionUUID->"9e3dd6f8-487b-462c-833c-ab7f50d1507e"],
Cell[14249, 367, 2762, 68, 199, "Input",ExpressionUUID->"5bda735d-a72c-4ec4-92b1-6c40e79424b5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17060, 441, 166, 3, 45, "Subsubsection",ExpressionUUID->"f1c102a2-66d3-4e8b-9565-52cc65d84cb6"],
Cell[17229, 446, 412, 9, 30, "Input",ExpressionUUID->"81befdfe-33c7-4250-8c4d-55ed11857f68"],
Cell[17644, 457, 509, 10, 30, "Input",ExpressionUUID->"f025af67-0ad5-4d02-af9d-da7bbc5787e0"],
Cell[18156, 469, 856, 20, 30, "Input",ExpressionUUID->"252a5dbe-1b70-4b8d-85e3-adb8d4f8f45c"],
Cell[19015, 491, 859, 21, 52, "Input",ExpressionUUID->"8678160a-6ee8-44df-af86-1404324f111c"],
Cell[CellGroupData[{
Cell[19899, 516, 417, 8, 30, "Input",ExpressionUUID->"b6620d06-355c-45b6-b437-57e7faa1cb4f"],
Cell[20319, 526, 3822, 62, 422, "Output",ExpressionUUID->"894d844e-e522-45db-a06e-fbce58c027dc"]
}, Open  ]],
Cell[24156, 591, 335, 8, 30, "Input",ExpressionUUID->"091d157a-e73c-4431-9181-ae92225bd953"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24528, 604, 170, 3, 45, "Subsubsection",ExpressionUUID->"c93c5a14-1ef1-4a6a-866e-0acbad9cff45"],
Cell[24701, 609, 395, 9, 30, "Input",ExpressionUUID->"ac75fc76-6229-41e7-8110-064bf100044f"],
Cell[25099, 620, 343, 8, 30, "Input",ExpressionUUID->"f55f59f6-e41e-4d0d-87bf-5d787f2b23ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25479, 633, 291, 6, 44, "Subsubsection",ExpressionUUID->"99122174-201a-47c7-83bf-f5cdc2e55f87"],
Cell[25773, 641, 335, 8, 30, "Input",ExpressionUUID->"32a8b8fa-ddae-45f0-bde8-c338eb110054"],
Cell[26111, 651, 293, 7, 30, "Input",ExpressionUUID->"36b6b87a-f400-49ce-877a-4e28bedaeb6b"],
Cell[26407, 660, 611, 10, 30, "Input",ExpressionUUID->"b1ad2c16-d47e-4cc9-9091-ad0be78bf71c"],
Cell[27021, 672, 1787, 42, 136, "Input",ExpressionUUID->"99bae985-d0e4-4a4c-bedc-fa119b26383b"],
Cell[CellGroupData[{
Cell[28833, 718, 776, 15, 30, "Input",ExpressionUUID->"d0a975e0-61f8-42eb-883b-38f0f7add731"],
Cell[29612, 735, 239, 5, 30, "Output",ExpressionUUID->"050f0f55-d209-42c2-b2de-7e7809a7fe34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29888, 745, 2678, 66, 136, "Input",ExpressionUUID->"04a0c601-35e0-45f7-82bc-c1080de44dc5"],
Cell[32569, 813, 1708, 35, 279, "Output",ExpressionUUID->"5297fe69-a77f-455d-9bd7-b4fa921f97d4"]
}, Open  ]],
Cell[34292, 851, 1232, 33, 52, "Input",ExpressionUUID->"98805845-431d-4506-868c-4f2ed5e6a65e"],
Cell[35527, 886, 1174, 33, 52, "Input",ExpressionUUID->"e4c6820a-e78f-415c-adf4-d8c4ccfadc0b"],
Cell[36704, 921, 340, 9, 30, "Input",ExpressionUUID->"5e24e407-e4f4-4a88-bff3-6705ee69d141"],
Cell[37047, 932, 1188, 28, 136, "Input",ExpressionUUID->"3a9f75d4-0c5a-4b84-965e-393b5330d51e"],
Cell[38238, 962, 3495, 71, 199, "Input",ExpressionUUID->"5c9e5d00-1f8b-4222-bf8b-1b91fea4261c"],
Cell[41736, 1035, 2168, 54, 178, "Input",ExpressionUUID->"cd891501-19e4-4889-b77e-d2f39ddf1bd7"]
}, Open  ]]
}, Open  ]]
}
]
*)

